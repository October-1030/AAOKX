# ✅ 真实交易安全验证清单

## 🚨 第一优先级（现在就做！）

### 1. 撤销暴露的 API 密钥

**⏰ 预计时间：2-3 分钟**

```
1. 访问: https://app.hyperliquid.xyz/API
2. 连接 MetaMask 钱包
3. 找到 API 钱包: 0xa42ca24c9fB4574306399Ec8d28c16522cD0B1F0
4. 点击 "Revoke" 或 "Delete"
5. 确认交易（支付少量 Gas 费）
```

**验证：** 刷新页面，确认该 API 密钥已从列表中消失

---

### 2. 检查账户安全

**⏰ 预计时间：2 分钟**

```
访问: https://app.hyperliquid.xyz/
```

**检查项：**
- [ ] 账户余额正常
- [ ] 没有异常交易记录（查看 Trade History）
- [ ] 没有未知持仓（查看 Positions）
- [ ] 最后一笔交易是你自己做的

**如果发现异常：**
1. 立即平掉所有持仓（点击 "Close All"）
2. 撤销所有 API 密钥
3. 转移资金到新钱包

---

## 📊 系统当前状态

### 已完成的安全措施 ✅

```
✅ USE_REAL_TRADING: false  (已关闭真实交易)
✅ Node.js 进程已停止
✅ 编译缓存已清除
✅ 创建了完整的安全配置指南
```

### 待完成的任务 ⏳

```
⏳ 撤销暴露的 API 密钥
⏳ 生成新的测试网 API 密钥
⏳ 测试网测试
⏳ （可选）主网小额测试
```

---

## 🧪 测试网配置（推荐先做）

### 1. 生成测试网 API 密钥

```bash
# 访问测试网 API 管理页面
https://app.hyperliquid-testnet.xyz/API

# 步骤：
1. 连接 MetaMask 钱包（会自动切换到测试网）
2. 点击 "Create API Key"
3. 设置权限：
   ✅ Trading (交易)
   ❌ Withdraw (不要开启！)
4. 保存生成的密钥：
   - API Wallet Address: 0x... (新地址)
   - API Secret Key: 0x... (私钥，保存到密码管理器)
```

### 2. 配置测试网环境变量

编辑 `.env.local`：
```env
# ==================================================
# Hyperliquid 测试网配置
# ==================================================

HYPERLIQUID_MAIN_WALLET=你的主钱包地址
HYPERLIQUID_API_WALLET=测试网API钱包地址
HYPERLIQUID_API_SECRET=测试网API密钥
HYPERLIQUID_TESTNET=true  # 使用测试网
```

### 3. 获取测试网资金

```bash
# 加入 Hyperliquid Discord
https://discord.gg/hyperliquid

# 在 #testnet-faucet 频道请求测试网 USDC
# 命令: /faucet 你的钱包地址
```

### 4. 启动测试

```bash
# 启动项目
npm run dev

# 观察启动日志，确认是测试网模式：
# [Hyperliquid] 📍 模式: Testnet  <-- 必须是这个
```

### 5. 执行测试交易

1. 打开浏览器: http://localhost:3000
2. 点击 "Execute Cycle" 按钮
3. 观察命令行日志：
   ```
   [RealTrading] 🚀 初始化真实交易执行器
   [RealTrading] 模式: 模拟  <-- 现在应该是模拟模式
   ```

4. 如果要启用测试网真实交易，修改 `lib/config.ts`:
   ```typescript
   USE_REAL_TRADING: true,
   ```
   然后重启项目。

---

## 🚀 主网配置（测试成功后）

### 风险确认

在启用主网真实交易前，请再次确认：

- [ ] ✅ 我已在测试网成功测试
- [ ] ✅ 我理解 AI 交易的风险
- [ ] ✅ 我准备好承担可能的资金损失
- [ ] ✅ 我只用愿意失去的资金测试（建议 ≤ $100）
- [ ] ✅ 我已设置合理的止损和资金限制

### 主网配置步骤

1. **生成主网 API 密钥**
   ```bash
   https://app.hyperliquid.xyz/API
   ```

2. **更新 `.env.local`**
   ```env
   HYPERLIQUID_MAIN_WALLET=主网钱包地址
   HYPERLIQUID_API_WALLET=主网API钱包地址
   HYPERLIQUID_API_SECRET=主网API密钥
   HYPERLIQUID_TESTNET=false  # 主网模式
   ```

3. **设置交易限制**

   编辑 `lib/tradingConfig.ts`（如果存在）或直接在代码中设置：
   ```typescript
   maxPositionSize: 50,      // 单笔最大 $50
   maxLeverage: 5,           // 最大 5x 杠杆
   maxDailyTrades: 10,       // 每日最多 10 笔
   ```

4. **启用真实交易**

   编辑 `lib/config.ts`:
   ```typescript
   USE_REAL_TRADING: true,  // ✅ 启用真实交易
   ```

5. **重启并监控**
   ```bash
   # 清除缓存
   rm -rf .next

   # 重新启动
   npm run dev
   ```

6. **验证真实交易模式**

   查看启动日志：
   ```
   Alpha Arena Configuration:
   - Trading Mode: ⚠️ LIVE TRADING (Hyperliquid)  <-- 确认
   ```

7. **执行第一笔交易（全程监控！）**

   - 点击 "Execute Cycle"
   - 观察命令行日志
   - 立即访问 https://app.hyperliquid.xyz/ 查看订单
   - 确认订单已成交且符合预期

---

## 📋 验证当前配置

### 快速检查命令

运行以下命令查看当前配置：

```bash
cd "D:\projects\alpha-arena-clone"
type lib\config.ts | findstr "USE_REAL"
```

应该显示：
```typescript
USE_REAL_TRADING: false, // ❌ 暂时关闭真实交易（安全模式）
```

### 检查环境变量

```bash
type .env.local | findstr "HYPERLIQUID"
```

确认：
- 如果还是旧密钥，**立即撤销并更新**
- `HYPERLIQUID_TESTNET=true` 表示测试网（安全）
- `HYPERLIQUID_TESTNET=false` 表示主网（需谨慎）

---

## 🆘 紧急情况处理

### 如果发现正在进行真实交易

1. **立即停止项目**
   ```bash
   # Windows
   taskkill /F /IM node.exe

   # 或按 Ctrl+C
   ```

2. **手动平仓**
   ```bash
   访问: https://app.hyperliquid.xyz/
   点击: "Close All Positions"
   ```

3. **撤销 API 密钥**
   ```bash
   访问: https://app.hyperliquid.xyz/API
   点击: "Revoke" 所有 API 密钥
   ```

4. **关闭真实交易**
   ```typescript
   // lib/config.ts
   USE_REAL_TRADING: false,
   ```

---

## 💡 常见问题

### Q: 如何确认系统真的在用测试网？

A: 检查三个地方：
1. `.env.local` 中 `HYPERLIQUID_TESTNET=true`
2. 启动日志显示 `[Hyperliquid] 📍 模式: Testnet`
3. 访问 https://app.hyperliquid-testnet.xyz/ 能看到交易记录

### Q: 测试网和主网可以同时运行吗？

A: 不行！同一时间只能用一个。需要切换时：
1. 修改 `.env.local` 中的 `HYPERLIQUID_TESTNET`
2. 重启项目

### Q: 如何完全禁用真实交易？

A: 两步：
1. `lib/config.ts`: `USE_REAL_TRADING: false`
2. 重启项目（清除 .next 缓存）

---

## 📞 获取帮助

- **Hyperliquid Discord**: https://discord.gg/hyperliquid
- **Hyperliquid 文档**: https://hyperliquid.gitbook.io/
- **测试网水龙头**: Discord #testnet-faucet 频道

---

## ✅ 最终检查清单

开始真实交易前，确认所有项：

- [ ] 已撤销暴露的旧 API 密钥
- [ ] 已生成新的 API 密钥
- [ ] 已在测试网成功测试
- [ ] 已设置合理的交易限制
- [ ] 已理解并接受所有风险
- [ ] `.env.local` 配置正确
- [ ] `USE_REAL_TRADING` 配置正确
- [ ] 准备好全程监控第一笔交易

---

**⚠️ 重要提醒：本系统仅供教育和研究用途。请只用你愿意失去的资金进行测试！**
